{% extends 'base_game.html' %}
{% block scripts %}

<script>
    const playerColor = '{{ player_color }}';

    function handleGameOver(winner, eloChange) {
        if (winner == playerColor) {
            playSound("win");
        }
        else {
            playSound("lose");
        }
        createGameOverUI(winner, eloChange, function() {
        location.reload();
    });
    }

    function handlePieceClick(piece) {
        // AJAX request to the server with the clicked position
        fetch('/singleplayer/move', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
                'X-CSRFToken': getCookie('csrftoken')
            },
            body: JSON.stringify({
                position: piece.userData.originalPosition,
                direction: sideToDirection(directionMapping['BACK']),
                player: playerColor,
                difficulty: '{{ difficulty|safe }}'
            })
        })
        .then(response => response.json())
        .then(data => {
            playSound("move");
            updateGameState(data.game_state);
            if (data.winner) {
                handleGameOver(data.winner);
            }
        })
        .catch(error => console.error('Error:', error));
    }
</script>
{% endblock %}
